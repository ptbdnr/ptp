
# Search, Select, and Follow Recipe

## Dependency
* [required] user account
* [optional] user's preferences: diet, budget
* [optional] user's ingredients: Array<(item,quantity,unit_of_measure)>
* [optional] user's equipment: Array<(item,quantity,unit_of_measure)>
* [optional] user's favourite recipes: Array<(item,quantity,unit_of_measure)>

## Steps

```mermaid
flowchart TD
    A[User clicks 'Recommend Recipe' button] --> B{System processes in parallel}
    B --> C[Query existing recipes]
    B --> D[Generate recipe titles with LLM]
    
    C --> E[Display recipe titles]
    D --> E
    
    E --> F[Run validation on ingredients & equipment]
    
    F --> G{Missing ingredients or equipment?}
    G -->|Yes| H[Suggest Shopping]
    G -->|No| I[User selects recipe]
    H --> I
    
    I --> J{Identify recipe source}
    J -->|Datastore| K[Fetch recipe details from datastore]
    J -->|LLM| L[Generate recipe details with LLM]
    
    K --> M[Display instructions and multimedia]
    L --> M
    
    M --> N[Optional: User provides feedback]
    
    classDef userAction fill:#d1f0ff,stroke:#0078d7,stroke-width:2px
    classDef systemAction fill:#e5e5e5,stroke:#333,stroke-width:1px
    classDef decision fill:#ffe6cc,stroke:#d79b00,stroke-width:1px
    classDef output fill:#d5e8d4,stroke:#82b366,stroke-width:1px
    
    class A,I,N userAction
    class B,C,D,E,F,J,K,L,M systemAction
    class G decision
    class H output
```

Here's a breakdown of the process:

1. **Initial Action**: The user starts by clicking the "Recommend Recipe" button.

2. **Parallel Processing**: The system works on two tracks simultaneously:
   - Querying the database for existing recipes
   - Using an LLM to generate new recipe titles

3. **Display & Validation**: After compiling options, the system:
   - Displays recipe titles to the user
   - Runs validation against the user's available ingredients and equipment
   - Suggests "Shopping" if items are missing

4. **Selection & Source Handling**: When the user selects a recipe, the system:
   - Identifies whether the recipe comes from the datastore or was generated by the LLM
   - Fetches or generates complete recipe details accordingly

5. **Presentation & Feedback**: Finally, the system:
   - Displays instructions and multimedia content
   - Provides an option for user feedback
